# Parameters for gtsam_slam_node

# Input topics: can be a single string or a list of strings.
# Use absolute topics (starting with '/') or relative ones resolved in the node's namespace.
pointcloud_topics:
  - mapping/scan_pointcloud
  - mapping/range_pointcloud

# Output topic for odometry (published as nav_msgs/Odometry).
# If left without a leading '/', it will be resolved relative to the node's namespace.
odometry_topic: slam/odometry

# TF frames used by the node.
# These mirror the launch defaults so configuration can live in one place.
# The launch file may still override these via <param>, but keeping them here
# makes the parameters discoverable and easier to manage.
map_frame: map
base_frame: barracuda/base_link

# OctoMap resolution (meters per voxel in the occupancy tree).
# Used as default leaf size for point cloud downsampling if not set explicitly.
octomap_resolution: 0.2

# Point cloud downsampling before inserting into OctoMap.
# When enabled, a PCL VoxelGrid filter reduces points by replacing points
# within a voxel with their centroid, greatly speeding up OctoMap insertion.
downsample_enabled: true
# Leaf size (meters) for the VoxelGrid. If omitted, defaults to octomap_resolution.
downsample_leaf_size: 0.2

# NDT odometry (scan-to-scan) configuration
# Set the input topic to the point cloud you want to drive odometry.
# If left empty, the node uses the first configured pointcloud topic.
ndt_enabled: true
ndt_odometry_input_topic: ""
ndt_resolution: 0.2         # meters (voxel grid size used internally by NDT)
ndt_step_size: 0.1          # line search step size
ndt_epsilon: 1.0e-6         # transformation epsilon (convergence)
ndt_max_iterations: 40      # max optimizer iterations
ndt_use_tf_init: true       # use TF delta as initial guess

# NDT odometry stability
ndt_keyframe_enabled: true
ndt_keyframe_trans_thresh: 0.20   # meters to create new keyframe
ndt_keyframe_rot_thresh_deg: 5.0  # degrees to create new keyframe

# NDT outlier filtering (applied before downsampling)
ndt_outlier_enabled: true
# methods: "sor" (statistical outlier removal) or "ror" (radius outlier removal)
ndt_outlier_method: "sor"
ndt_sor_mean_k: 20
ndt_sor_stddev_mul: 1.0
ndt_ror_radius: 0.5
ndt_ror_min_neighbors: 2

# NDT submap to reduce drift (scan-to-submap)
ndt_submap_enabled: true
ndt_submap_max_keyframes: 5
ndt_submap_voxel_leaf: 0.2

# Do not publish TF; EKF handles map->odom->base_link
publish_tf: false
